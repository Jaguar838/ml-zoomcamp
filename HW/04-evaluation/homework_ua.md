## Домашнє завдання

> Примітка: іноді ваша відповідь може не відповідати точно жодному з варіантів. Це нормально. Оберіть варіант, який найбільше відповідає вашому рішенню.

У цьому завданні ми будемо використовувати датасет Bank Marketing. Завантажте його [тут](https://archive.ics.uci.edu/static/public/222/bank+marketing.zip).

Ви можете завантажити його за допомогою `wget`:

```bash
wget https://archive.ics.uci.edu/static/public/222/bank+marketing.zip
unzip bank+marketing.zip 
unzip bank.zip
```

Нам потрібен файл `bank-full.csv`.

У цьому датасеті цільова змінна - `y`, яка показує, чи підписався клієнт на терміновий депозит.

### Підготовка датасету

Для решти завдання вам потрібно використовувати лише такі стовпці:

* `'age'`,
* `'job'`,
* `'marital'`,
* `'education'`,
* `'balance'`,
* `'housing'`,
* `'contact'`,
* `'day'`,
* `'month'`,
* `'duration'`,
* `'campaign'`,
* `'pdays'`,
* `'previous'`,
* `'poutcome'`,
* `'y'`

Розділіть дані на три частини: train/validation/test у співвідношенні 60%/20%/20%. Для цього використовуйте функцію `train_test_split` і `random_state=1`.

### Питання 1: ROC AUC для важливості ознак

ROC AUC також можна використовувати для оцінки важливості ознак для числових змінних.

Давайте зробимо це

* Для кожної числової змінної використайте її як оцінку та обчисліть AUC із змінною `above_average`
* Для цього використовуйте тренувальний датасет

Якщо ваш AUC менше 0,5, інвертуйте цю змінну, поставивши перед нею знак мінус ("-").

(наприклад, `-df_train['engine_hp']`)

AUC може бути меншим за 0,5, якщо змінна має негативну кореляцію із цільовою змінною. Ви можете змінити напрямок кореляції, інвертуючи змінну - тоді негативна кореляція стане позитивною.

Яка числова змінна (серед наступних 4) має найвищий AUC?

- `balance`
- `day`
- `duration`
- `previous`

### Питання 2: Навчання моделі

Застосуйте кодування one-hot за допомогою `DictVectorizer` та навчіть логістичну регресію з такими параметрами:

```python
LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)
```

Який AUC цієї моделі на валідаційному датасеті? (округліть до 3 знаків)

- 0.69
- 0.79
- 0.89
- 0.99

### Питання 3: Точність та Повнота

Тепер обчислімо точність (precision) та повноту (recall) для нашої моделі.

* Оцініть модель для всіх порогів від 0.0 до 1.0 з кроком 0.01
* Для кожного порогу обчисліть точність та повноту
* Побудуйте їх графік

На якому порозі точність і повнота перетинаються?

* 0.265
* 0.465
* 0.665
* 0.865

### Питання 4: F1 Score

Точність та повнота суперечливі - коли одна зростає, інша знижується. Тому вони часто об’єднуються у F1 score - метрику, яка враховує обидві.

Формула для обчислення F1:

$$F_1 = 2 \cdot \cfrac{P \cdot R}{P + R}$$

Де $P$ - точність і $R$ - повнота.

Обчислімо F1 для всіх порогів від 0.0 до 1.0 з кроком 0.01

На якому порозі F1 є максимальним?

- 0.02
- 0.22
- 0.42
- 0.62

### Питання 5: 5-кратна крос-валідація

Використовуйте клас `KFold` із Scikit-Learn, щоб оцінити нашу модель на 5 різних фолдах:

```
KFold(n_splits=5, shuffle=True, random_state=1)
```

* Ітеруйтеся по різних фолдах `df_full_train`
* Розділіть дані на train та validation
* Навчіть модель на train з такими параметрами: `LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)`
* Оцініть модель на валідації за допомогою AUC

Яке стандартне відхилення оцінок для різних фолдів?

- 0.0001
- 0.006
- 0.06
- 0.26

### Питання 6: Налаштування гіперпараметрів

Тепер використаємо 5-кратну крос-валідацію, щоб знайти найкращий параметр `C`

* Переберіть такі значення `C`: `[0.000001, 0.001, 1]`
* Ініціалізуйте `KFold` із тими ж параметрами, що й раніше
* Використайте ці параметри для моделі: `LogisticRegression(solver='liblinear', C=C, max_iter=1000)`
* Обчисліть середню оцінку та стандартне відхилення (округліть середнє та стандартне відхилення до 3 знаків)

Яке значення `C` дає найкращий середній результат?

- 0.000001
- 0.001
- 1

Якщо є рівні результати, виберіть той, у якого менше стандартне відхилення. Якщо знову буде рівність, виберіть найменше `C`.

## Надішліть результати

* Надішліть свої результати тут: https://courses.datatalks.club/ml-zoomcamp-2024/homework/hw04
* Якщо ваша відповідь не збігається точно з варіантами, виберіть найближчий