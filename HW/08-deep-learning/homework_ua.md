## Домашнє завдання

> **Примітка**: дуже ймовірно, що у цьому завданні ваші відповіді не будуть повністю збігатися з запропонованими варіантами. Це нормально й очікувано. Оберіть варіант, який найближчий до вашого рішення.

### Набір даних

У цьому завданні ми створимо модель для класифікації різних типів волосся.  
Для цього ми будемо використовувати набір даних *Hair Type*, отриманий із  
[Kaggle](https://www.kaggle.com/datasets/kavyasreeb/hair-type-dataset)  
та трохи змінений.

Ви можете завантажити потрібний набір даних для цього завдання за посиланням:  
[тут](https://github.com/SVizor42/ML_Zoomcamp/releases/download/straight-curly-data/data.zip):

```bash
wget https://github.com/SVizor42/ML_Zoomcamp/releases/download/straight-curly-data/data.zip
unzip data.zip
```

На лекціях ми розглядали, як використовувати попередньо навчені нейронні мережі. У цьому завданні ми будемо навчати модель значно меншого розміру з нуля.

> **Примітка**: вам потрібне середовище з GPU для виконання цього завдання. Ми рекомендуємо використовувати [Saturn Cloud](https://bit.ly/saturn-mlzoomcamp).  
> Ви також можете використовувати комп’ютер без GPU (наприклад, ноутбук), але це буде повільніше.

### Підготовка даних

Набір даних містить близько 1000 зображень волосся у розділених папках  
для навчального та тестового наборів.

### Відтворюваність

Відтворюваність у глибокому навчанні є багатогранною задачею, яка потребує уваги  
до деталей програмного й апаратного забезпечення. У деяких випадках ми не можемо  
гарантувати абсолютно однакові результати під час повторних запусків експерименту.  
Тому в цьому завданні ми пропонуємо:
* встановити версію `tensorflow 2.17.1`
* встановити генератори випадкових чисел за допомогою:

```python
import numpy as np
import tensorflow as tf

SEED = 42
np.random.seed(SEED)
tf.random.set_seed(SEED)
```

### Модель

У цьому завданні ми будемо використовувати згорткову нейронну мережу (*CNN*).  
Як і на лекціях, ми використовуватимемо Keras.

Вам потрібно створити модель зі структурою:

* Вхідний шар повинен мати розмірність `(200, 200, 3)`
* Наступний шар — згортковий ([`Conv2D`](https://keras.io/api/layers/convolution_layers/convolution2d/)):
  * Використовуйте 32 фільтри
  * Розмір ядра повинен бути `(3, 3)` (розмір фільтра)
  * Використовуйте активацію `'relu'`
* Зменште розмір карти ознак за допомогою max pooling ([`MaxPooling2D`](https://keras.io/api/layers/pooling_layers/max_pooling2d/)):
  * Встановіть розмір пулінгу `(2, 2)`
* Перетворіть багатовимірний результат у вектор за допомогою шару [`Flatten`](https://keras.io/api/layers/reshaping_layers/flatten/)
* Додайте повнозв'язний (`Dense`) шар із 64 нейронами та активацією `'relu'`
* Створіть вихідний шар із 1 нейроном — це буде вихідний шар:
  * Для цього шару використовуйте відповідну активацію для задачі бінарної класифікації.

В якості оптимізатора використовуйте [`SGD`](https://keras.io/api/optimizers/sgd/) із такими параметрами:

* `SGD(lr=0.002, momentum=0.8)`

Для уточнення щодо розміру ядра та max pooling перегляньте [Office Hours](https://www.youtube.com/watch?v=1WRgdBTUaAc).

... (продовження йде таким же чином).